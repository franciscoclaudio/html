<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Ferramentas Vetoriais</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* Overlay para melhorar a legibilidade sobre a imagem */
    body::before { 
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.4); 
        z-index: -1; 
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-image: url("https://blog.stoodi.com.br/wp-content/uploads/2020/02/goemetria-anal%C3%ADtica-1024x674.jpg");
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center center;
      background-attachment: fixed;
      color: #f0f0f0; /* Texto do body fora do container */
    }
    .container {
      max-width: 500px;
      margin: 40px auto; 
      padding: 30px 20px;
      background: rgba(140, 170, 175, 0.95); /* Levemente transparente */
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      border-radius: 12px;
    }
    h1 {
      font-size: 2.2em;
      color: #1d0601;
      text-align: center;
      margin-bottom: 25px;
      font-weight: bold;
    }
    label {
      font-size: 1.05em;
      margin-bottom: 6px;
      display: block;
      color: #1d0601;
      font-weight: 600;
    }
    select, input[type="number"] {
      width: 100%;
      font-size: 1.1em;
      padding: 10px;
      margin-bottom: 12px;
      border: 1px solid #777;
      border-radius: 6px;
      box-sizing: border-box;
      transition: border-color 0.3s;
    }
    select:focus, input[type="number"]:focus {
        border-color: #0057b8;
        outline: none;
    }
    .input-group {
      margin-bottom: 16px;
    }
    button {
      width: 100%;
      background: #0057b8;
      color: #fff;
      font-size: 1.1em;
      padding: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 15px;
      margin-bottom: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      transition: background 0.3s, transform 0.1s;
    }
    button:hover {
        background: #00428d;
    }
    button:active {
      background: #003c7a;
      transform: translateY(1px);
    }
    #resultado {
      font-size: 1.1em;
      background: #f0f0f0;
      color: #1d0601;
      padding: 18px;
      border-radius: 8px;
      margin-top: 20px;
      font-weight: bold;
      text-align: center;
      word-break: break-word;
      border: 2px solid #0057b8;
    }
    @media (max-width: 600px) {
      .container {
        margin: 0;
        padding: 15px 10px 30px 10px;
        box-shadow: none;
        border-radius: 0;
        background: rgba(140, 170, 175, 0.98); 
      }
      h1 {
        font-size: 1.8em;
      }
      label, #resultado {
        font-size: 1em;
      }
      button {
        font-size: 1em;
        padding: 12px;
      }
    }

  </style>
</head>
<body>
  <div class="container">
    <h1>Ferramentas Vetoriais</h1> 
    <label for="opcao">Escolha uma operação:</label>
    <select id="opcao">
      <option value="1">Produto escalar</option>
      <option value="2">Produto vetorial</option>
      <option value="3">Módulo de vetor</option>
      <option value="4">Projeção de v1 sobre v2</option>
      <option value="5">Vetor Altura do paralelogramo (v1 - proj_v2(v1))</option>
      <option value="6">Equação do plano</option>
      <option value="7">Distância de ponto ao plano</option>
      <option value="8">Soma de vetores</option>
      <option value="9">Subtração de vetores</option>
      <option value="10">Distância de ponto à reta</option>
    </select>

    <form id="formulario">
      </form>
    <button onclick="calcular()">Calcular</button>
    <div id="resultado"></div>
  </div>
<script>
function prod_esc(v1, v2) {
  return v1.reduce((acc, val, i) => acc + val * v2[i], 0);
}
function prod_vet(v1, v2) {
  return [
    v1[1]*v2[2] - v1[2]*v2[1],
    -(v1[0]*v2[2] - v1[2]*v2[0]),
    v1[0]*v2[1] - v1[1]*v2[0]
  ];
}
function mod(v1) {
  return Math.sqrt(v1.reduce((acc, val) => acc + val*val, 0));
}
function proj(v1, v2) {
  let mod_v2_sq = mod(v2) * mod(v2);
  if (mod_v2_sq === 0) {
    throw new Error("O vetor v2 não pode ser o vetor nulo (divisão por zero).");
  }
  let alpha = prod_esc(v1, v2) / mod_v2_sq;
  return v2.map(x => alpha * x);
}
function alt(v1, v2) {
  let projecao = proj(v1, v2);
  return v1.map((x, i) => x - projecao[i]);
}
function equacao_plano(v1, v2, p) {
  let diretor = prod_vet(v1, v2);
  let d = -(diretor[0]*p[0] + diretor[1]*p[1] + diretor[2]*p[2]);
  return [...diretor, d];
}
function print_vet(v) {
  // Retorna com o símbolo de vetor (seta para a direita)
  return `\u{2192}[${v.map(x => x.toFixed(5)).join(', ')}]`;
}
function distancia_ponto_plano(p, n, d) {
  let mod_val = n.reduce((acc, ni, i) => acc + ni * p[i], 0) + d;
  let n1 = n.reduce((acc, ni) => acc + ni*ni, 0);
  if (n1 === 0) {
    throw new Error("O vetor normal do plano não pode ser o vetor nulo.");
  }
  return Math.abs(mod_val) / Math.sqrt(n1);
}
function soma_vet(v1, v2) {
  return v1.map((x, i) => x + v2[i]);
}
function sub_vet(v1, v2) {
  return v1.map((x, i) => x - v2[i]);
}
function distancia_ponto_reta(P, Po, V) {
  let mod_V = mod(V);
  if (mod_V === 0) {
    throw new Error("O vetor diretor da reta não pode ser o vetor nulo.");
  }
  let vetor = sub_vet(P, Po); // P - Po
  // O vetor 'v1' é o vetor ortogonal (altura) entre P e a reta, cuja magnitude é a distância
  let v1 = alt(vetor, V); 
  return [v1, mod(v1)];
}
function criarInputs(campos) {
  let form = document.getElementById('formulario');
  form.innerHTML = '';
  campos.forEach(campo => {
    let grupo = document.createElement('div');
    grupo.className = 'input-group';
    grupo.innerHTML = `<label for="${campo.nome}0">${campo.label}</label>`;
    for(let i=0; i<campo.dim; i++) {
      // Adicionado title para acessibilidade
      grupo.innerHTML += `<input type="number" inputmode="decimal" step="any" id="${campo.nome}${i}" placeholder="Coord. ${i+1}" title="Coordenada ${i+1} de ${campo.label.replace(':','')}" required>`;
    }
    form.appendChild(grupo);
  });
  if(campos.some(c => c.nome === "n") && campos.some(c => c.nome === "p")) {
    let grupo = document.createElement('div');
    grupo.className = 'input-group';
    grupo.innerHTML = `<label for="d">Constante do plano (d):</label>
    <input type="number" inputmode="decimal" step="any" id="d" placeholder="Valor de D na equação Ax+By+Cz+D=0" required>`;
    form.appendChild(grupo);
  }
}
function getVetor(nome, dim=3) {
  let v = [];
  for(let i=0; i<dim; i++) {
    v.push(parseFloat(document.getElementById(nome+i).value));
  }
  return v;
}
document.getElementById('opcao').addEventListener('change', function() {
  const val = this.value;
  let campos = [];
  if(val=="1"||val=="2"||val=="4"||val=="5"||val=="8"||val=="9")
    campos=[{nome:"v1", label:"Vetor v1:", dim:3},{nome:"v2", label:"Vetor v2:", dim:3}];
  else if(val=="3")
    campos=[{nome:"v1", label:"Vetor:", dim:3}];
  else if(val=="6")
    campos=[{nome:"v1", label:"Vetor v1 (direção):", dim:3},{nome:"v2", label:"Vetor v2 (direção):", dim:3},{nome:"p", label:"Ponto do plano (Po):", dim:3}];
  else if(val=="7")
    campos=[{nome:"p", label:"Ponto P:", dim:3},{nome:"n", label:"Normal do plano (n):", dim:3}];
  else if(val=="10")
    campos=[{nome:"P", label:"Ponto P:", dim:3},{nome:"Po", label:"Ponto Po (origem da reta):", dim:3},{nome:"V", label:"Vetor diretor da reta (V):", dim:3}];
  criarInputs(campos);
});
document.getElementById('opcao').dispatchEvent(new Event('change'));
function calcular() {
  const val = document.getElementById('opcao').value;
  let res = '';
  try {
    if(val=="1") {
      let v1=getVetor('v1'), v2=getVetor('v2');
      res = "Produto escalar: " + prod_esc(v1,v2).toFixed(5);
    }
    else if(val=="2") {
      let v1=getVetor('v1'), v2=getVetor('v2');
      res = "Produto vetorial: " + print_vet(prod_vet(v1,v2));
    }
    else if(val=="3") {
      let v1=getVetor('v1');
      res = "Módulo do vetor: " + mod(v1).toFixed(5);
    }
    else if(val=="4") {
      let v1=getVetor('v1'), v2=getVetor('v2');
      res = "Projeção de v1 sobre v2: " + print_vet(proj(v1,v2));
    }
    else if(val=="5") {
      let v1=getVetor('v1'), v2=getVetor('v2');
      let altura = alt(v1, v2);
      res = "Vetor Altura ($\mathbf{v_h}$): " + print_vet(altura) + " | Módulo: " + mod(altura).toFixed(5);
    }
    else if(val=="6") {
      let v1=getVetor('v1'), v2=getVetor('v2'), p=getVetor('p');
      let eq = equacao_plano(v1,v2,p);
      if (mod([eq[0], eq[1], eq[2]]) === 0) {
        throw new Error("Vetores de direção paralelos. O plano não pode ser determinado.");
      }
      res = `Equação do plano: ${eq[0].toFixed(5)}*X + ${eq[1].toFixed(5)}*Y + ${eq[2].toFixed(5)}*Z + ${eq[3].toFixed(5)} = 0`;
    }
    else if(val=="7") {
      let p=getVetor('p'), n=getVetor('n');
      let d=parseFloat(document.getElementById('d').value);
      res = "Distância do ponto ao plano: " + distancia_ponto_plano(p,n,d).toFixed(5);
    }
    else if(val=="8") {
      let v1=getVetor('v1'), v2=getVetor('v2');
      res = "Soma dos vetores: " + print_vet(soma_vet(v1,v2));
    }
    else if(val=="9") {
      let v1=getVetor('v1'), v2=getVetor('v2');
      res = "Subtração dos vetores: " + print_vet(sub_vet(v1,v2));
    }
    else if(val=="10") {
      let P=getVetor('P'), Po=getVetor('Po'), V=getVetor('V');
      let [resultado, distancia] = distancia_ponto_reta(P,Po,V);
      res = "Vetor Distância ($\mathbf{v_d}$): " + print_vet(resultado) + " | Distância: " + distancia.toFixed(5);
    }
  } catch(e) {
    // Captura erros de parsing ou de divisão por zero.
    res = "Erro: " + (e.message || "Preencha todos os campos corretamente!");
  }
  document.getElementById('resultado').textContent = res;
}
</script>
</body>
</html>